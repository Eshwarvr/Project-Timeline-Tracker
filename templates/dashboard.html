{% extends "base.html" %}

{% block title %}Dashboard - Timeline Tracker{% endblock %}

{% block content %}
<h1 class="mb-4">Project Dashboard</h1>

<div class="row">
    <div class="col-md-4">
        <div class="card text-white bg-primary mb-4 shadow">
            <div class="card-body text-center">
                <h5 class="card-title">Total Projects</h5>
                <h1 class="display-4">{{ total_projects }}</h1>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-success mb-4 shadow">
            <div class="card-body text-center">
                <h5 class="card-title">Active Projects</h5>
                <h1 class="display-4">{{ active_projects }}</h1>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white bg-danger mb-4 shadow">
            <div class="card-body text-center">
                <h5 class="card-title">Overdue Projects</h5>
                <h1 class="display-4">{{ overdue_count }}</h1>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card shadow">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h4 class="mb-0">All Projects</h4>
                <a href="/add-project" class="btn btn-light btn-sm">
                    <i class="bi bi-plus-circle"></i> Add New Project
                </a>
            </div>
            <div class="card-body">
                {% if projects %}
                <div class="table-responsive">
                    <table class="table table-striped table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Project Name</th>
                                <th>Client</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th class="text-center">Milestones</th>
                                <th>Status</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for project in projects %}
                            <tr>
                                <td><strong>{{ project.project_name }}</strong></td>
                                <td>{{ project.client_name }}</td>
                                <td>{{ project.start_date|ddmmyyyy }}</td>
                                <td>{{ project.end_date|ddmmyyyy }}</td>
                                <td class="text-center">
                                    <span class="badge bg-info">{{ project.milestones|length }}</span>
                                </td>
                                <td>
                                    {% if project.status == "Completed" %}
                                        <span class="badge bg-success">Completed</span>
                                    {% elif project.status == "Overdue" %}
                                        <span class="badge bg-danger">Overdue</span>
                                    {% elif project.status == "In Progress" %}
                                        <span class="badge bg-warning text-dark">In Progress</span>
                                    {% else %}
                                        <span class="badge bg-secondary">Not Started</span>
                                    {% endif %}
                                </td>
                                <td class="text-center">
                                    <a href="/project/{{ project.id }}" class="btn btn-sm btn-info me-1">
                                        View
                                    </a>
                                    <a href="#" class="btn btn-sm btn-danger" 
                                    onclick="showDeleteProjectModal('{{ project.id }}', '{{ project.project_name }}'); return false;">
                                    Delete
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="text-center py-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" class="bi bi-folder-x text-muted mb-3" viewBox="0 0 16 16">
                        <path d="M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181L15.546 8H14.54l.265-2.91A1 1 0 0 0 13.81 4H2.19a1 1 0 0 0-.996 1.09l.637 7a1 1 0 0 0 .995.91h9.348l.728-2H3.819a2 2 0 0 1-1.99-1.82l-.289-3.18Z"/>
                        <path d="M11.854 10.146a.5.5 0 0 0-.707.708L12.293 12l-1.146 1.146a.5.5 0 0 0 .707.708L13 12.707l1.146 1.147a.5.5 0 0 0 .708-.708L13.707 12l1.147-1.146a.5.5 0 0 0-.708-.708L13 11.293l-1.146-1.147Z"/>
                    </svg>
                    <h5 class="text-muted">No projects yet</h5>
                    <p class="text-muted">Get started by creating your first project</p>
                    <a href="/add-project" class="btn btn-primary">
                        <i class="bi bi-plus-circle"></i> Add Your First Project
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}